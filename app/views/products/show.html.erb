<h1 id="product-title"><%= @product.name %> - <%= _("Detailed view") %></h1>

<div id="product-info">
  <div id="product-image">
    <div id="product-image-border">
      <div id="image">
        <%= image_tag @product.photo.url(:small) %>
      </div>
    </div>
  </div>

  <div id="product-details">
    <dl id="product-publisher">
      <dt><%= _("Publisher") %>:</dt>
      <dd><%= link_to @product.publisher.username, @product.publisher %></dd>
    </dl>

    <dl id="product-platform">
    <dt><%= n_("Platform", "Platforms", @product.platforms.length) %>:</dt>
    <% @product.platforms.each do |platform| %>
      <dd><%= platform.name %>&nbsp;</dd>
    <% end %>
    </dl>

    <dl id="product-published">
      <dt><%= _("Published") %>:</dt>
      <dd><%= l @product.updated_at.to_date, :format => :long %></dd>
    </dl>

    <dl id="product-popularity">
      <dt><%= _("Number of views") %>:</dt>
      <dd><%= @product.popularity %></dd>
    </dl>

    <dl id="product-rating">
      <dt><%= _("Rating") %>:</dt>
      <dd>
        <%= render :partial => 'ratings/rating', :object => @product.avg_rating %>
        
        <% if logged_in? && @product.publisher != current_user %>
          <div id="product-rating-form">
            <%= _("Your rating:") %>
            <%= render 'ratings/form' %>
          </div>
        <% end %>
      </dd>
    </dl>

    <dl id="product-url">
      <dt><%= _("URL") %>:</dt>
      <dd><%= link_to @product.url, "http://"+@product.url, :target => '_blank' %></dd>
    </dl>

    <dl id="product-description">
      <dt><%= _("Description") %>:</dt>
      <dd><%= word_wrap(@product.description) %></dd>
    </dl>

    <% if (can_edit, can_delete = can?(:edit, @product), can?(:delete, @product)).any? %>
      <dl id="product-admin">
        <dt><%= _("Admin") %>:</dt>
        <dd><%= button_to _('Edit'), edit_product_path(@product), :method => :get,
                                     :class => "smallbutton" if can_edit %></dd>
        <dd><%= button_to _('Delete'), @product, :class=>"smallbutton", :method => :delete,
                                       :confirm => _('Are you sure?') if can_delete %></dd>
      </dl>
    <% end %>
		<br>
    <%=button_to _('Report issue'), 'http://www.sizzlelab.org/contact', :class => 'smallbutton', :method => :get %>
  </div>
</div>

<div class="product_comment">
  <% if can? :show, Comment %>
    <h2><%= _("Comments") %>:</h2>
    <div id="product-comment-list">
      <%= render :partial => "comment/list", :collection => @comments, :as => :comment %>
    </div>
  <% end %>
 
  <p>
    <% if can? :new, Comment %>
      <%= render :partial => "comment/form" %>
    <% else %>
      <b><%= _("Please login to add comments") %></b>
    <% end %>
  </p>

<%= button_to _('Back'), :back, :class => 'smallbutton', :method => :get %>
</div>
