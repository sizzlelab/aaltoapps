<!DOCTYPE html>
<html>
<head>
  <title><%= _("Aalto Apps") %></title>

  <script type="text/javascript">
    <%# pass translated strings to javascript
        (passing plural forms won't work with this simple method) %>
    var translations = {
      edit:    '<%= escape_javascript raw _('Edit') %>',
      cancel:  '<%= escape_javascript raw _('Cancel') %>',
      loading: '<%= escape_javascript raw _('loading...') %>',
      close:   '<%= escape_javascript raw _('Close') %>',
      accept:  '<%= escape_javascript raw _('Accept') %>',
      decline: '<%= escape_javascript raw _('Decline') %>'
    };
  </script>

  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.14/jquery-ui.min.js"></script>
  <%# TODO: replace with local customized css: %>
  <link rel="stylesheet" type="text/css" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.12/themes/base/jquery-ui.css" />

  <%= stylesheet_link_tag :all %>
  <%= javascript_include_tag :defaults %>
  <%= csrf_meta_tag %>

</head>
<body lang="<%= I18n.locale %>">
  <div class="layout_whole">
    <div class="wrapper_top">
      <div class="layout_info">
        <div class="layout_menuitem">
          <%= _("Choose language:") %>
          <%= render :partial => '/layouts/locale_selector' %>
        </div>
        <div class="layout_menuitem">
          <%= render :partial => '/layouts/mobile_version_selector' %>
        </div>
        <div class="layout_menuitem">
          <%= render :partial => "/users/login_menu" %>
        </div>
        <div class="layout_menuitem">
          <%=render :partial=>"/products/search"%>
        </div>
      </div>
      <div class="layout_logo">
        <%= link_to "aalto apps", root_path %>
      </div>
    </div>

    <div class="layout_frame">
      <div class="layout_master">
        <div id="notice"><%= notice %></div>
        <div id="alert"><%= alert %></div>
        <%= content_for?(:content) ? yield(:content) : yield %>
      </div>

      <div class="footer_text">
        <a target="_blank" href="http://www.sizzlelab.org">Sizzlelab.org</a> |
        <a target="_blank" href="http://otasizzle.wordpress.com">OtaSizzle blog</a> |
        <a target="_blank" href="http://www.sizzlelab.org/content/legal-information">Legal Information</a> |
        <a target="_blank" href="http://www.sizzlelab.org/content/frequently-asked-questions-faq">FAQ</a> |
        <a target="_blank" href="http://www.sizzlelab.org/content/howto">HOWTOs</a> |
        <a target="_blank" href="http://www.sizzlelab.org/contact">Feedback</a>
      </div>
      <div class="clear"></div>
    </div>
  </div>

  <div id="menu">
    <div class="navmenu">
      <li><div class="menusingle"><%= link_to _("home"), root_path %></div></li>
      <li id="menu-browse"><div class="menutop"><%= link_to _("browse") %> </div>
        <ul>
          <div class="submenu">
            <li class="submenu_row"><%=link_to _("All"), products_path %> </li>
            <% Platform.all.each do |platform|%>
              <li class="submenu_row"><%=link_to platform.name, platforms_path+"/%{p_id}/products/" % {:p_id => platform.id} %> </li>
             <%end%>
          </div>
        </ul>
      </li>
      <% if logged_in? %>
        <li id="menu-publish">
          <div class="menutop"><%= link_to _("publish") %></div>
            <ul>
              <div class="submenu">
                <li class="submenu_row"><%=link_to _("My Apps"), products_path(:myapps=>true) %> </li>
                <li class="submenu_row"><%=link_to _("New App"), new_product_path %> </li>
              </div>
            </ul>
        </li>
      <% end %>

      <% if (can_approve, can_i_users, can_i_platforms =
               can?(:approve, Product), can?(:index, User), can?(:index, Platform)
            ).any?
      %>
        <li id="menu-admin">
          <div class="menutop"><%= link_to _("admin") %></div>
          <ul>
            <div class="submenu">
              <% if can_approve %>
                <li class="submenu_row"><%= link_to _('New products'),
                                                    products_path(:approval => 'submitted')
                                        %></li>
                <li class="submenu_row"><%= link_to _('Products pending approval'),
                                                    products_path(:approval => 'pending')
                                        %></li>
                <li class="submenu_row"><%= link_to _('Blocked products'),
                                                    products_path(:approval => 'blocked')
                                        %></li>
              <% end %>
              <% if can_i_users %>
                <li class="submenu_row"><%= link_to _('Users'), users_path %></li>
              <% end %>
              <% if can_i_platforms %>
                <li class="submenu_row"><%= link_to _('Platforms'), platforms_path %></li>
              <% end %>
            </div>
          </ul>
        </li>
      <% end %>

    </div>
  </div>
</body>
</html>
