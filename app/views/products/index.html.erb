<% if @show_welcome_info %>
  <div id="welcome_msg" align="center">
    <%= render :partial => '/welcome_message' %>
  </div>
<%end%>

<% unless @err_msg.blank? %>
  <br/><br/>
  <div class="browse_search_err_msg" align="center">
    <h1><%= @err_msg %></h1>
  </div>
<%end%>

<% if @featured_products && !@featured_products.empty? %>
  <div id="browse_featured_products" class="browse_products">
    <h1><%=
      if @platform.present?
        _("Listing featured %{platform} applications") % {:platform => @platform.name}
      else
        _("Listing featured applications")
      end
    %></h1>
    <%= render :partial=>'product', :collection => @featured_products %>
  </div>
<% end %>

<%
  title = case @view_type
    when :myapps
      _("Listing my applications")
    when :approval
      _("Listing applications with status: %{status}") % {:status => approval_status(@approval_state)}
    when :index then case
      when @search
        _("Search results")
      when @platform.present?
        _("Listing %{platform} applications") % {:platform => @platform.name}
      else
        _("Listing all applications")
      end
  end
%>

<% if @products.blank? %>
  <div class="browse_products">
    <h1><%= title %></h1>
    <div class="no_products_msg"><%= _("No applications available.") %></div>
  </div>
<% else %>
  <div class="browse_products">
    <h1><%= title %></h1>

    <ul id='product_selection_bar'>
      <%
        # sort headers
        [ ['created_at', _('Publication date')],
          ['popularity', _('Popularity')],
          ['avg_rating', _('User rating')],
        ].each do |key, title|
      %>
        <% if key == @sort %>
          <li class="selected-sort-key"><%= title %></li>
        <% else %>
          <li><%= link_to title, products_path_with_params(:sort => key) %></li>
        <% end %>
      <% end %>
    </ul>
    <br /><br />

<div class="clear"></div>

    <%= render :partial=>'product', :collection => @products %>
  </div>

  <div class="browse_paginate">
    <%= will_paginate @products,
                      :previous_label => _('&#8592; Previous'),
                      :next_label     => _('Next &#8594;') %>
  </div>
<% end %>
